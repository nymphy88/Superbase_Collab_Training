
-- Supabase Schema for AI Training Control Center

CREATE TABLE IF NOT EXISTS game_configs (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  initial_player_balance FLOAT8 NOT NULL DEFAULT 1000.0,
  bet_amount FLOAT8 NOT NULL DEFAULT 10.0,
  counter_fee FLOAT8 NOT NULL DEFAULT 5.0,
  win_payout FLOAT8 NOT NULL DEFAULT 10.0,
  counter_win_payout FLOAT8 NOT NULL DEFAULT 25.0,
  dealer_stand INT4 NOT NULL DEFAULT 17,
  total_timesteps BIGINT NOT NULL DEFAULT 1000000,
  max_balance_ref FLOAT8 DEFAULT 2000.0,
  refill_penalty FLOAT8 DEFAULT -50.0
);

CREATE TABLE IF NOT EXISTS training_logs (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  step BIGINT NOT NULL,
  house_profit FLOAT8 NOT NULL,
  player_money FLOAT8 NOT NULL,
  win_rate FLOAT4 NOT NULL,
  counter_usage FLOAT4 NOT NULL,
  refill_count INT4 NOT NULL DEFAULT 0
);

CREATE TABLE IF NOT EXISTS system_commands (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  command TEXT NOT NULL,
  payload JSONB DEFAULT '{}',
  processed BOOLEAN DEFAULT FALSE
);
